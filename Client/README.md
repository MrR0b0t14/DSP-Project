# Client

This folder contains the code of the client, all the files at it associated and also the folder for the exceptions.

## Implementation Choices
In this section are reported the implementation choices for a better understanding of the output. To run only the client, please skip to the next section.

### File ID Generation
The file **_ID_** generated by the client is created starting from the path and the file itself, this is done to help the server reducing the collisions; the function provided to generate the _**ID**_, has 2 possible implementations, according the level of security that wants to be achieved:
  - **Weak Solution**: The hash is computed only over the file path, file changes are not detected (Default). This is the mode provided with the commits, if you want, you can switch to the other mode in the _startNewinteraction_ function, by setting the second parameter of the _pathToId_ function at true.
  - **Strong Solution**: The hash is computed over the file (it is then a digest of it) so that, if multiple clients are sending different files named with the same name at the same path at the same time, the server is not limited by the timestamp precision (check timestamp section in the server readme, with millis is able to manage 1000 reqs per second) to avoid conflicts on creating files.
Moreover, the generated ID is made up of only ASCII characters but for readability have been chosen only letters and digits (a-z, A-Z, 0-9).

### Edge Cases
Many problems have been considered but since the messages exchanged in the protocol are fixed, some assumptions must be done:
  -  Whenever the client sends the filename to the server as a second parameter, it is possible to re-open the file and continue writing. It is up to the client to not modify the content of the file once the transfer has finished. By the way, even by changing it, it is only possible to append data to the previous ones (no overwriting) and the size of the file must be bigger than the size of the written file on the server, otherwise a **_FileHasChangedException_** is thrown.
  - The client detects if the connection has been dropped in one of the following cases:
      - The TIMEOUT is reached → Client will print _“TCP Connection Interrupted”._
      - Client reads on the socket stream a ‘-1’ → Client will print _“TCP Connection Interrupted”_.
      - An **_IOException_** is thrown after the subsequent closure of the connection → Client will print _“TCP Connection Interrupted”_.
  - The client has been designed such that if it is called with 2 arguments and the server is not able to find the fileName but the second argument is a valid file ID (this means that the server will answer _**'0'**_ when client expects **_'2'_**), the Client will throw a  **_WrongPassingArgumentException_**. 

Many others assumptions have been done, but they may have not been reported in this README, so that can be discussed at the oral.

## How To Run
First of all start the server, this means that if you haven't read the **_"README.md"_** file in the Server folder, please do it first.
Once you have started the server, you have to put yourself in the **"_src_"** folder inside the **"_Client_"** one. So from the Client folder run:

    cd src

Then, you must compile client files so run:

    javac it/polito/dsp/*.java

And to start the client (ONLY AFTER THAT YOU STARTED THE SERVER) run:

    java it.polito.dsp.FileTransfer <path>

or, if in recovery mode:

    java it.polito.dsp.FileTransfer <path> <recoveryFileName>

The kind of path that you specify must include the file to be transferred so, for a linux user, e.g.:

    java it.polito.dsp.FileTransfer /home/user/folder/fileToTransfer.txt
